<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Integration1D (integration1d.Integration1D)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">integration1d</a> &#x00BB; Integration1D</nav><h1>Module <code>Integration1D</code></h1><p>Routines for one dimensional numerical integration.</p></header><dl><dt class="spec type" id="type-integrator"><a href="#type-integrator" class="anchor"></a><code><span class="keyword">type</span> integrator</code><code> = </code><table class="variant"><tr id="type-integrator.GAUSS15" class="anchored"><td class="def constructor"><a href="#type-integrator.GAUSS15" class="anchor"></a><code>| </code><code><span class="constructor">GAUSS15</span></code></td><td class="doc"><p>7 - 15 points</p></td></tr><tr id="type-integrator.GAUSS21" class="anchored"><td class="def constructor"><a href="#type-integrator.GAUSS21" class="anchor"></a><code>| </code><code><span class="constructor">GAUSS21</span></code></td><td class="doc"><p>10 - 21 points</p></td></tr><tr id="type-integrator.GAUSS31" class="anchored"><td class="def constructor"><a href="#type-integrator.GAUSS31" class="anchor"></a><code>| </code><code><span class="constructor">GAUSS31</span></code></td><td class="doc"><p>15 - 31 points</p></td></tr><tr id="type-integrator.GAUSS41" class="anchored"><td class="def constructor"><a href="#type-integrator.GAUSS41" class="anchor"></a><code>| </code><code><span class="constructor">GAUSS41</span></code></td><td class="doc"><p>20 - 41 points</p></td></tr><tr id="type-integrator.GAUSS51" class="anchored"><td class="def constructor"><a href="#type-integrator.GAUSS51" class="anchor"></a><code>| </code><code><span class="constructor">GAUSS51</span></code></td><td class="doc"><p>25 - 51 points</p></td></tr><tr id="type-integrator.GAUSS61" class="anchored"><td class="def constructor"><a href="#type-integrator.GAUSS61" class="anchor"></a><code>| </code><code><span class="constructor">GAUSS61</span></code></td><td class="doc"><p>30 - 61 points</p></td></tr></table></dt><dd><p>Choice of local integration rule: which Gauss-Kronrod pair is used.</p></dd></dl><dl><dt class="spec type" id="type-reliability"><a href="#type-reliability" class="anchor"></a><code><span class="keyword">type</span> reliability</code><code> = </code><table class="variant"><tr id="type-reliability.OK" class="anchored"><td class="def constructor"><a href="#type-reliability.OK" class="anchor"></a><code>| </code><code><span class="constructor">OK</span></code></td><td class="doc"><p>normal and reliable termination of the routine. it is assumed that the requested accuracy has been achieved.</p></td></tr><tr id="type-reliability.Limit" class="anchored"><td class="def constructor"><a href="#type-reliability.Limit" class="anchor"></a><code>| </code><code><span class="constructor">Limit</span></code></td><td class="doc"><p>maximum number of subdivisions allowed has been achieved. one can allow more subdivisions by increasing the value of <code>limit</code>.</p><p>However, if this yields no improvement it is rather advised to analyze the integrand in order to determine the integration difficulties. If the position of a local difficulty can be determined (e.g. singularity, discontinuity within the interval) one will probably gain from splitting up the interval at this point and calling the integrator on the subranges. If possible, an appropriate special-purpose integrator should be used which is designed for handling the type of difficulty involved.</p></td></tr><tr id="type-reliability.Roundoff" class="anchored"><td class="def constructor"><a href="#type-reliability.Roundoff" class="anchor"></a><code>| </code><code><span class="constructor">Roundoff</span></code></td><td class="doc"><p>The occurrence of roundoff error is detected, which prevents the requested tolerance from being achieved.</p></td></tr><tr id="type-reliability.Bad_integrand" class="anchored"><td class="def constructor"><a href="#type-reliability.Bad_integrand" class="anchor"></a><code>| </code><code><span class="constructor">Bad_integrand</span></code></td><td class="doc"><p>Extremely bad integrand behaviour occurs at some points of the integration interval.</p></td></tr></table></dt><dt class="spec type" id="type-result"><a href="#type-result" class="anchor"></a><code><span class="keyword">type</span> result</code><code> = </code><code>{</code><table class="record"><tr id="type-result.res" class="anchored"><td class="def field"><a href="#type-result.res" class="anchor"></a><code>res : float;</code></td><td class="doc"><p>Approximation to the integral.</p></td></tr><tr id="type-result.err" class="anchored"><td class="def field"><a href="#type-result.err" class="anchor"></a><code>err : float;</code></td><td class="doc"><p>Estimate of the modulus of the absolute error, which should equal or exceed abs(res - result).</p></td></tr><tr id="type-result.neval" class="anchored"><td class="def field"><a href="#type-result.neval" class="anchor"></a><code>neval : int;</code></td><td class="doc"><p>Number of integrand evaluations.</p></td></tr><tr id="type-result.nsub" class="anchored"><td class="def field"><a href="#type-result.nsub" class="anchor"></a><code>nsub : int;</code></td><td class="doc"><p>Number of sub-intervals used <code>&lt;= limit</code>.</p></td></tr><tr id="type-result.msg" class="anchored"><td class="def field"><a href="#type-result.msg" class="anchor"></a><code>msg : <a href="index.html#type-reliability">reliability</a>;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec exception" id="exception-Function_not_finite"><a href="#exception-Function_not_finite" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Function_not_finite</span> <span class="keyword">of</span> float</code></dt><dd><p><code>Function_not_finite(x)</code> is raised when the function one seeks to integrate returns NaN, <code>infinity</code> or <code>neg_infinity</code> at <code>x</code>.</p></dd></dl><dl><dt class="spec type" id="type-workspace"><a href="#type-workspace" class="anchor"></a><code><span class="keyword">type</span> workspace</code></dt><dd><p>Temporary memory used by the integration routines.</p></dd></dl><dl><dt class="spec value" id="val-workspace"><a href="#val-workspace" class="anchor"></a><code><span class="keyword">val</span> workspace : <a href="index.html#type-integrator">integrator</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-workspace">workspace</a></code></dt><dd><p><code>workspace i limit</code> creates a workspace for the integrator <code>i</code> that can handle up to <code>limit</code> sub-intervals.</p></dd></dl><dl><dt class="spec value" id="val-qag"><a href="#val-qag" class="anchor"></a><code><span class="keyword">val</span> qag : <span>?&#8288;limit:int</span> <span>&#45;&gt;</span> <span>?&#8288;workspace:<a href="index.html#type-workspace">workspace</a></span> <span>&#45;&gt;</span> <a href="index.html#type-integrator">integrator</a> <span>&#45;&gt;</span> <span>?&#8288;epsabs:float</span> <span>&#45;&gt;</span> <span>?&#8288;epsrel:float</span> <span>&#45;&gt;</span> <span>(float <span>&#45;&gt;</span> float)</span> <span>&#45;&gt;</span> float <span>&#45;&gt;</span> float <span>&#45;&gt;</span> <a href="index.html#type-result">result</a></code></dt><dd><p><code>qag integrator</code> returns a function <code>integ</code> so that <code>integ f a b</code> is an approximation, <code>i</code>, to the integral <code>f</code> over the interval <code>(a,b)</code> hopefully satisfying following claim for accuracy <code>abs(i -
    true_result) &lt;= max epsabs (epsrel*abs(i))</code>. ⚠ BEWARE that <code>qag integrator</code> creates a workspace that will be used for all calls of <code>integ</code>, so you should not call <code>integ</code> inside <code>f</code> or call the same <code>integ</code> in parallel.</p><p>Keywords: automatic integrator, general-purpose, integrand examinator, globally adaptive, Gauss-Kronrod.</p><dl><dt>parameter epsabs</dt><dd><p>absolute accuracy requested (default <code>1.49E-8</code>).</p></dd></dl><dl><dt>parameter epsrel</dt><dd><p>relative accuracy requested (default <code>1.49E-8</code>).</p></dd></dl><dl><dt>parameter limit</dt><dd><p>gives an upper-bound on the number of sub-intervals in the partition of (a,b); must satisfy <code>limit &gt;= 1</code>. Default: <code>50</code>.</p></dd></dl><dl><dt>parameter workspace</dt><dd><p>Temporary memory used by the integration routines. It is recommended to allocate this memory outside loops. Default: new temporary memory is allocated as needed. A nice way of allocating temprary ressources once only is to use partial evaluation: <code>let integ = qag integrator</code> and then use it repeatedly as <code>integ f a b</code>.</p></dd></dl><dl><dt>raises Failure</dt><dd><p>if <code>epsabs &lt;= 0 &amp;&amp; epsrel &lt;= max (50 * eps_float) 0.5E-28</code></p></dd></dl><dl><dt>raises Function_not_finite</dt><dd><p>if the function <code>f</code> returns NaN or an infinite value at an evaluation point.</p></dd></dl></dd></dl></div></body></html>